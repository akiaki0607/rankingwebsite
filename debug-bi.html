<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>BI工具排行榜 - 调试页面</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; }
        .success { color: green; }
        .error { color: red; }
        pre { background: #f5f5f5; padding: 10px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>BI工具排行榜 - 参考信源调试</h1>
    
    <div class="section">
        <h2>URL 参数检查</h2>
        <div id="urlCheck"></div>
    </div>
    
    <div class="section">
        <h2>数据加载检查</h2>
        <div id="dataCheck"></div>
    </div>
    
    <div class="section">
        <h2>References 数据</h2>
        <div id="referencesData"></div>
    </div>
    
    <div class="section">
        <h2>DOM 元素检查</h2>
        <div id="domCheck"></div>
    </div>

    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const industryId = urlParams.get('industry');
        const rankingId = urlParams.get('id');
        
        // URL检查
        document.getElementById('urlCheck').innerHTML = `
            <p>industry 参数: <strong>${industryId || '❌ 未找到'}</strong></p>
            <p>id 参数: <strong>${rankingId || '❌ 未找到'}</strong></p>
            <p class="${industryId && rankingId ? 'success' : 'error'}">
                ${industryId && rankingId ? '✅ URL参数正常' : '❌ URL参数缺失'}
            </p>
            <p>正确的URL应该是: <code>debug-bi.html?industry=enterprise-bi-tools&id=bi-tools-ranking-2025</code></p>
        `;
        
        // 数据加载
        async function debugLoad() {
            try {
                const response = await fetch(`data/${industryId}.json`);
                const industry = await response.json();
                
                document.getElementById('dataCheck').innerHTML = `
                    <p class="success">✅ 数据加载成功</p>
                    <p>行业名称: <strong>${industry.name}</strong></p>
                    <p>是否有 references: <strong>${!!industry.references}</strong></p>
                    <p>references 数量: <strong>${industry.references ? industry.references.length : 0}</strong></p>
                `;
                
                // References数据
                if (industry.references && industry.references.length > 0) {
                    const refHtml = industry.references.map((ref, i) => `
                        <div style="margin: 10px 0; padding: 10px; background: #f9f9f9;">
                            <strong>${i + 1}. ${ref.title}</strong><br>
                            <small>${ref.description}</small>
                        </div>
                    `).join('');
                    
                    document.getElementById('referencesData').innerHTML = `
                        <p class="success">✅ 找到 ${industry.references.length} 个参考信源</p>
                        ${refHtml}
                    `;
                } else {
                    document.getElementById('referencesData').innerHTML = `
                        <p class="error">❌ 没有找到参考信源数据</p>
                    `;
                }
                
                // DOM检查
                document.getElementById('domCheck').innerHTML = `
                    <p>需要检查的元素:</p>
                    <ul>
                        <li>referencesSection: ${document.getElementById('referencesSection') ? '✅ 存在' : '❌ 不存在'}</li>
                        <li>referencesList: ${document.getElementById('referencesList') ? '✅ 存在' : '❌ 不存在'}</li>
                    </ul>
                    <p class="error">注意: 这个调试页面没有实际的DOM元素，请在 ranking.html 页面查看</p>
                `;
                
            } catch (error) {
                document.getElementById('dataCheck').innerHTML = `
                    <p class="error">❌ 数据加载失败: ${error.message}</p>
                `;
            }
        }
        
        if (industryId && rankingId) {
            debugLoad();
        } else {
            document.getElementById('dataCheck').innerHTML = `
                <p class="error">❌ 缺少URL参数，无法加载数据</p>
                <p>请使用正确的URL: <a href="debug-bi.html?industry=enterprise-bi-tools&id=bi-tools-ranking-2025">点击这里</a></p>
            `;
        }
    </script>
</body>
</html>
